spring:
  application:
    name: spring-ai-resos-mcp-server

  ai:
    mcp:
      server:
        name: ${spring.application.name}
        version: 1.2-modified
        type: SYNC
        protocol: STREAMABLE
        streamable-http:
          mcp-endpoint: /mcp

  jackson:
    default-property-inclusion: non_null

  main:
    banner-mode: off
    # Removed web-application-type: none to enable HTTP server for WebMVC

  threads:
    virtual:
      enabled: true

  # OAuth2 Resource Server configuration for validating incoming tokens
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: ${AUTH_SERVER_URL:http://localhost:8080}

management:
  info:
    build:
      enabled: true
    git:
      mode: FULL
    java:
      enabled: true
    os:
      enabled: true
  endpoint:
    health:
      show-details: ALWAYS
    metrics:
      enabled: true
  endpoints:
    web:
      exposure:
        include: info,health,metrics,loggers,sbom

default:
  url: ${RESOS_API_ENDPOINT:https://api.resos.com/v1}

# OAuth2 Client Configuration for backend authentication
security:
  oauth2:
    enabled: ${OAUTH2_ENABLED:true}

spring.security.oauth2.client:
  registration:
    mcp-server:
      client-id: ${MCP_CLIENT_ID:mcp-server}
      client-secret: ${MCP_CLIENT_SECRET:mcp-server-secret}
      authorization-grant-type: client_credentials
      scope: backend.read,backend.write
  provider:
    mcp-server:
      token-uri: ${AUTH_SERVER_URL:http://localhost:8080}/oauth2/token

logging:
  pattern:
    console:
  file:
    name: ${user.home}/logs/spring-ai-resos-mcp-server.log

---
spring:
  config:
    activate:
      on-profile: cloud

  main:
    banner-mode: log
    # Removed web-application-type: reactive (now uses servlet/WebMVC)

  ai:
    mcp:
      server:
        # stdio: false not needed (HTTP is default for WebMVC)
        # type: SYNC is the default for WebMVC starter

logging:
  pattern:
    console: "%clr(%d{yy-MM-dd E HH:mm:ss.SSS}){blue} %clr(%-5p) %clr(${PID}){faint} %clr(---){faint} %clr([%8.15t]){cyan} %clr(%-40.40logger{0}){blue} %clr(:){red} %clr(%m){faint}%n"

---
spring:
  config:
    activate:
      on-profile: dev

debug: true

management:
  endpoints:
    web:
      exposure:
        include: "*"

# Override default.url for local development
default:
  url: ${RESOS_API_ENDPOINT:http://localhost:8080}

server:
  port: 8082

logging:
  level:
    me.pacphi: DEBUG
    org.springframework.security: DEBUG
    org.springframework.web.client: DEBUG
